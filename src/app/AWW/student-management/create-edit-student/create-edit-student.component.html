

<div class="container">
  <!-- Mobile-first header -->
  <div class="header-section mb-4">
    <h2 class="heading-heading mb-0">
    <span class="heading-highlight">{{isEditMode ? 'Edit' : 'Add'}}</span> Student
  </h2>
  </div>
  
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading data...</p>
  </div>

  <form [formGroup]="studentForm" (ngSubmit)="onSubmit()" *ngIf="!isLoading" class="student-form">
    <div class="form-container">
      <div class="row g-3">
        <div class="col-12 col-md-6">
          <mat-form-field appearance="outline" class="w-100 mobile-form-field">
          <mat-label>First Name</mat-label>
          <input matInput formControlName="firstName" placeholder="Enter first name">
          <mat-error *ngIf="studentForm.get('firstName')?.hasError('required')">
            First name is required
          </mat-error>
        </mat-form-field>
      </div>

        <div class="col-12 col-md-6">
          <mat-form-field appearance="outline" class="w-100 mobile-form-field">
          <mat-label>Last Name</mat-label>
          <input matInput formControlName="lastName" placeholder="Enter last name">
          <mat-error *ngIf="studentForm.get('lastName')?.hasError('required')">
            Last name is required
          </mat-error>
        </mat-form-field>
      </div>

        <div class="col-12 col-md-6">
          <mat-form-field appearance="outline" class="w-100 mobile-form-field">
          <mat-label>Date of Birth</mat-label>
          <input matInput [matDatepicker]="picker" formControlName="dateOfBirth">
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
          <mat-error *ngIf="studentForm.get('dateOfBirth')?.hasError('required')">
            Date of birth is required
          </mat-error>
        </mat-form-field>
      </div>

        <div class="col-12 col-md-6">
          <mat-form-field appearance="outline" class="w-100 mobile-form-field">
          <mat-label>Symbol</mat-label>
          <input matInput formControlName="symbol" placeholder="Enter symbol">
          <mat-error *ngIf="studentForm.get('symbol')?.hasError('required')">
            Symbol is required
          </mat-error>
        </mat-form-field>
      </div>

        <div class="col-12 col-md-6">
          <mat-form-field appearance="outline" class="w-100 mobile-form-field">
          <mat-label>Height (cm)</mat-label>
          <input matInput type="number" formControlName="height" placeholder="Enter height">
          <mat-error *ngIf="studentForm.get('height')?.hasError('required')">
            Height is required
          </mat-error>
          <mat-error *ngIf="studentForm.get('height')?.hasError('min')">
            Height must be greater than 0
          </mat-error>
        </mat-form-field>
      </div>

        <div class="col-12 col-md-6">
          <mat-form-field appearance="outline" class="w-100 mobile-form-field">
          <mat-label>Weight (kg)</mat-label>
          <input matInput type="number" formControlName="weight" placeholder="Enter weight">
          <mat-error *ngIf="studentForm.get('weight')?.hasError('required')">
            Weight is required
          </mat-error>
          <mat-error *ngIf="studentForm.get('weight')?.hasError('min')">
            Weight must be greater than 0
          </mat-error>
        </mat-form-field>
      </div>

        <div class="col-12 col-md-6">
          <mat-form-field appearance="outline" class="w-100 mobile-form-field">
          <mat-label>Home Language</mat-label>
          <input matInput formControlName="language" placeholder="Enter home language">
          <mat-error *ngIf="studentForm.get('language')?.hasError('required')">
            Home language is required
          </mat-error>
        </mat-form-field>
      </div>

        <div class="col-12 col-md-6">
          <mat-form-field appearance="outline" class="w-100 mobile-form-field">
          <mat-label>Gender</mat-label>
          <mat-select formControlName="gender" placeholder="Select gender">
            <mat-option value="Boy">Boy</mat-option>
            <mat-option value="Girl">Girl</mat-option>
            <mat-option value="N/A">N/A</mat-option>
          </mat-select>
          <mat-error *ngIf="studentForm.get('gender')?.hasError('required')">
            Gender is required
          </mat-error>
        </mat-form-field>
      </div>

        <div class="col-12 col-md-6">
          <mat-form-field appearance="outline" class="w-100 mobile-form-field">
          <mat-label>Anganwadi Center</mat-label>
          <input matInput [value]="currentAnganwadiName" readonly>
          <mat-hint *ngIf="!isEditMode">Student will be assigned to your center</mat-hint>
        </mat-form-field>
        <!-- Hidden field to store the anganwadi ID -->
        <input type="hidden" formControlName="anganwadiId">
      </div>

        <div class="col-12 col-md-6">
          <mat-form-field appearance="outline" class="w-100 mobile-form-field">
          <mat-label>Assigned Worker</mat-label>
          <input matInput [value]="currentUserName" readonly>
          <mat-hint *ngIf="!isEditMode">Student will be assigned to you</mat-hint>
        </mat-form-field>
        <!-- Hidden field to store the AWW ID -->
        <input type="hidden" formControlName="awwId">
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button class="btn btn-outline-secondary" type="button" (click)="goBack()">Cancel</button>
      <button type="submit" [disabled]="studentForm.invalid" [ngClass]="{'btn-secondary': studentForm.invalid, 'btn-primary': !studentForm.invalid}" class="btn submit-btn">
        {{isEditMode ? 'Update' : 'Create'}} Student
      </button>
    </div>
  </form>
</div>